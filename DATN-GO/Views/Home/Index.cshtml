@model DATN_GO.ViewModels.HomeViewModel


@{
    ViewData["Title"] = "Home Page";

}
<section class="slideshow mb-3">
    <div class="row">
        <div class="col-md-9">
            <div class="row">
                <div class="col-md-8 mb-2">
                    <div id="mainCarousel" class="carousel slide" data-bs-ride="carousel">
                        <div class="carousel-indicators">
                            <button type="button" data-bs-target="#mainCarousel" data-bs-slide-to="0"
                                    class="active" aria-current="true" aria-label="Slide 1"></button>
                            <button type="button" data-bs-target="#mainCarousel" data-bs-slide-to="1"
                                    aria-label="Slide 2"></button>
                            <button type="button" data-bs-target="#mainCarousel" data-bs-slide-to="2"
                                    aria-label="Slide 3"></button>
                        </div>
                        <div class="carousel-inner rounded-2 carousel-img">
                            <div class="carousel-item active">
                                <img src="https://i.pinimg.com/736x/9d/3f/fa/9d3ffa34744058f4925bb23cf6db72b4.jpg"
                                     alt="Food 1">
                                <div class="carousel-caption carousel-caption-custom">
                                    <h3>Khám phá ẩm thực Việt Nam</h3>
                                    <p>Trải nghiệm hương vị độc đáo của các món ăn truyền thống</p>
                                </div>
                            </div>
                            <div class="carousel-item">
                                <img src="https://i.pinimg.com/736x/00/17/63/0017631d7ed34e0a714c40feee8e479d.jpg"
                                     alt="Food 2">
                                <div class="carousel-caption carousel-caption-custom">
                                    <h3>Món ăn đặc sắc</h3>
                                    <p>Thưởng thức những món ăn ngon từ các đầu bếp hàng đầu</p>
                                </div>
                            </div>
                            <div class="carousel-item">
                                <img src="https://i.pinimg.com/736x/a2/c3/31/a2c33191ad5463acb80142eabcde22b8.jpg"
                                     alt="Food 3">
                                <div class="carousel-caption carousel-caption-custom">
                                    <h3>Ưu đãi đặc biệt</h3>
                                    <p>Giảm giá lên đến 50% cho các món ăn yêu thích</p>
                                </div>
                            </div>
                        </div>
                        <button class="carousel-control-prev" type="button" data-bs-target="#mainCarousel"
                                data-bs-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Previous</span>
                        </button>
                        <button class="carousel-control-next" type="button" data-bs-target="#mainCarousel"
                                data-bs-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Next</span>
                        </button>
                    </div>
                </div>

                <div class="col-md-4 mb-2">
                    <div class="ratio ratio-16x9 h-100">
                        <iframe class="rounded-2" src="https://www.youtube.com/embed/dA0VGEbbw4g"
                                title="Food Video" allowfullscreen></iframe>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-3 mb-2">
            <div class="row advertisement">
                <div class="col-12">
                    <div class="position-relative">
                        <img src="https://i.pinimg.com/736x/a2/c3/31/a2c33191ad5463acb80142eabcde22b8.jpg"
                             class="rounded-4" alt="Top promotion">
                        <div class="advertisement-caption">Khuyến mãi đặc biệt</div>
                    </div>
                </div>
                <div class="col-12">
                    <div class="position-relative">
                        <img src="https://i.pinimg.com/736x/86/6c/d2/866cd2867f9f2b7e6e3594fb1b8230dd.jpg"
                             class="rounded-4" alt="Bottom promotion">
                        <div class="advertisement-caption">Món ngon mới nhất</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Categories Section with Circular Scrolling -->
<section class="categories-section mb-3">
    <h2 class="fw-bold mb-4">Danh Mục</h2>
    <div class="categories-slider position-relative" data-aos="fade-up">
        <div class="owl-carousel category-carousel">
            @foreach (var category in Model.Categories)
            {
                <div class="category-wrapper">
                    <div class="category-item text-center">
                        <div class="category-circle">
                            <img src="@category.Image" alt="@category.Name" />
                        </div>
                        <h6 class="mb-0">@category.Name</h6>
                    </div>
                </div>
            }
        </div>
    </div>
</section>
<section class="popular-restaurants mb-3">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="fw-bold mb-0">Nhà Hàng Nổi Bật</h2>
        <button id="toggleStoresBtn" class="btn btn-outline-danger rounded-pill">Xem tất cả</button>
    </div>
    <div class="row g-4" id="storeList">
        @if (Model.Stores != null && Model.Stores.Any())
        {
            var storeIndex = 0;
            @foreach (var store in Model.Stores)
            {
                <div class="col-lg-6 store-card @(storeIndex >= 2 ? "d-none" : "")" data-aos="fade-up">
                    <div class="restaurant-card card border-0 shadow-sm hover-scale">
                        <div class="row g-0">
                            <div class="col-md-4">
                                <img src="@(!string.IsNullOrEmpty(store.Avatar) ? store.Avatar : "/images/no-image.png")"
                                     class="img-fluid rounded-start h-100" style="object-fit: cover;" alt="@store.Name">
                            </div>
                            <div class="col-md-8">
                                <div class="card-body">
                                    <div class="d-flex justify-content-between align-items-start mb-2">
                                        <h5 class="card-title fw-bold mb-1">@store.Name</h5>
                                        <span class="badge bg-success">
                                            Mở cửa
                                        </span>

                                    </div>
                                    <p class="card-text text-muted small mb-2 text-truncate-1">
                                        <i class="bi bi-geo-alt-fill icon-sm"></i> @store.Address
                                    </p>
                                    <div class="d-flex align-items-center mb-2">
                                        <div class="rating text-warning me-2">
                                            @for (int i = 1; i <= 5; i++)
                                            {
                                                <i class="bi @(i <= Math.Round(store.Rating) ? "bi-star-fill" : "bi-star") icon-sm"></i>
                                            }
                                        </div>
                                        <span class="text-muted small">(@store.Rating.ToString("0.0") điểm)</span>
                                    </div>
                                    <a asp-controller="Store" asp-action="Details" asp-route-id="@store.Id"
                                       class="btn btn-outline-danger rounded-pill">Xem chi tiết</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                storeIndex++;
            }

        }
        else
        {
            <p class="text-muted">Hiện chưa có cửa hàng nổi bật.</p>
        }
    </div>
</section>


<section class="featured-products mb-3">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="fw-bold mb-0">Sản Phẩm Nổi Bật</h2>
        <button id="toggleProductsBtn" class="btn btn-outline-danger rounded-pill">Xem tất cả</button>
    </div>
    <div class="row g-4" id="productList">
        @if (Model.FeaturedProducts != null && Model.FeaturedProducts.Any())
        {
            var productIndex = 0;
            foreach (var product in Model.FeaturedProducts)
            {
                <div class="col-lg-3 col-md-4 col-sm-6 product-card @(productIndex >= 4 ? "d-none" : "")" data-aos="fade-up">
                    <div class="product-card card h-100 border-0 shadow-sm hover-scale">
                        <div class="position-relative">
                            <img src="@product.MainImage" class="card-img-top" style="height: 200px; object-fit: cover;" alt="@product.Name" />
                            <div class="product-badge bg-danger text-white position-absolute top-0 end-0 m-2 px-2 py-1 rounded-pill">
                                -20%
                            </div>
                        </div>
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <span class="badge bg-light text-danger">@product.CategoryName</span>
                                <div class="rating text-warning">
                                    <i class="bi bi-star-fill icon-sm"></i>
                                    <span class="ms-1 text-dark">@product.Rating.ToString("0.0")</span>
                                </div>
                            </div>
                            <h5 class="card-title fw-bold mb-1 text-truncate-1">@product.Name</h5>
                            <p class="card-text text-muted small mb-2 text-truncate-1">@product.StoreName</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <span class="text-danger fw-bold">@product.Price.ToString("N0")đ</span>
                                </div>
                                <button class="btn btn-crimson btn-sm rounded-pill">
                                    <i class="bi bi-cart-plus icon-sm"></i> Thêm
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                productIndex++;
            }
        }
        else
        {
            <p class="text-muted">Hiện chưa có sản phẩm nổi bật.</p>
        }
    </div>
</section>


<!-- Trend Categories -->
<!-- Trend Categories -->
<section class="hot-trend mb-3">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div class="d-flex align-items-center">
            <h2 class="fw-bold mb-0 me-3">Thịnh hành</h2>
            <div class="trending-badge d-flex align-items-center bg-danger text-white px-3 py-2 rounded-pill">
                <i class="bi bi-fire me-2 icon-lg"></i>
                <span>Xu hướng</span>
            </div>
        </div>
    </div>
    <div class="row g-4">
        @if (Model.TrendCategories != null && Model.TrendCategories.Any())
        {
            foreach (var category in Model.TrendCategories)
            {
                <div class="col-lg-3 col-md-6" data-aos="fade-up">
                    <div class="trend-category-card position-relative overflow-hidden rounded-4">
                        <div class="trend-category-image">
                            <img src="@category.Image" class="w-100" alt="@category.Name">
                            <div class="trend-category-overlay"></div>
                        </div>
                        <div class="trend-category-content text-center text-white">
                            <div class="trend-category-icon mb-3">
                                <i class="bi bi-star-fill icon-lg"></i>
                            </div>
                            <h3 class="trend-category-title mb-2">@category.Name</h3>
                            <p class="trend-category-stat mb-3">
                                <span class="badge bg-danger me-2">Top @category.Rank</span>
                                <span>@category.TotalProducts món ăn</span>
                            </p>
                            <a href="#" class="btn btn-light rounded-pill px-4">Khám phá ngay</a>
                        </div>
                    </div>
                </div>
            }
        }
        else
        {
            <p class="text-muted">Chưa có danh mục xu hướng.</p>
        }
    </div>



<section class="all-products mb-3">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="fw-bold mb-0">Gợi ý cho bạn</h2>
    </div>

    @if (Model.SuggestedProducts != null && Model.SuggestedProducts.Any())
    {
        <div class="row g-4">
            @foreach (var product in Model.SuggestedProducts.Take(4))
            {
                <div class="col-xl-3 col-lg-4 col-md-6">
                    <div class="product-card card h-100 border-0 shadow-sm hover-scale">
                        <div class="position-relative">
                            <img src="@product.MainImage" class="card-img-top"
                                 style="height: 200px; object-fit: cover;" alt="@product.Name" />
                        </div>
                        <div class="card-body">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <span class="badge bg-light text-danger">@product.CategoryName</span>
                                <div class="rating text-warning">
                                    <i class="bi bi-star-fill icon-sm"></i>
                                    <span class="ms-1 text-dark">@product.Rating.ToString("0.0")</span>
                                </div>
                            </div>
                            <h5 class="card-title fw-bold mb-1 text-truncate-1">@product.Name</h5>
                            <p class="card-text text-muted small mb-2 text-truncate-1">@product.StoreName</p>
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <span class="text-danger fw-bold">@product.Price.ToString("N0")đ</span>
                                </div>
                                <button class="btn btn-crimson btn-sm rounded-pill">
                                    <i class="bi bi-cart-plus icon-sm"></i> Thêm
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    }
    else
    {
        <p class="text-muted">Chưa có sản phẩm gợi ý.</p>
    }
</section>




@section Scripts {
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            // --- Cửa hàng nổi bật ---
            const storeBtn = document.getElementById("toggleStoresBtn");
            const storeCards = document.querySelectorAll(".store-card");
            let storeExpanded = false;
            const defaultStoreVisible = 2;

            storeBtn.addEventListener("click", function () {
                storeExpanded = !storeExpanded;
                storeCards.forEach((card, index) => {
                    if (index >= defaultStoreVisible) {
                        card.classList.toggle("d-none", !storeExpanded);
                    }
                });
                storeBtn.textContent = storeExpanded ? "Thu gọn" : "Xem tất cả";
            });

            // --- Sản phẩm nổi bật ---
            const btn = document.getElementById("toggleProductsBtn");
            // CHỈ bắt các thẻ trong #productList, không đụng "Gợi ý cho bạn"
            const cards = document.querySelectorAll("#productList .product-card");
            let expanded = false;

            btn.addEventListener("click", function () {
                expanded = !expanded;
                cards.forEach((card, index) => {
                    if (!expanded && index >= 4) {
                        card.classList.add("d-none");
                    } else {
                        card.classList.remove("d-none");
                    }
                });
                btn.textContent = expanded ? "Thu gọn" : "Xem tất cả";
            });
        });
    </script>
}